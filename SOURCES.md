# Sources

In SmartEvents, a `Source` is a component of a `Processor` that connects to an external source of events (hence the name)
and, if they are matched by a [Filter](FILTERS.md), automatically injects them in the system.

Processors containing sources are called **"source processors"**.

It is **not possible** to create a processor containing an [Action](ACTIONS.md) and a `Source` at the same time.

When a new source `Processor` is requested using the endpoint `/api/v1/bridges/{id}/processors` you must specify the `Source` to connect to and, optionally, one or more [Filters](FILTERS.md).
If no filter is specified, all the events coming from the `Source` are injected in the system.

[Transformations](TRANSFORMATIONS.md) are currently not supported in source processors.

## Parameters of a Source

Each `Source` has 2 parameters to specify:
- `type`: the type of the `Source`. This must be one of the supported `Source` types listed below
  - Attempting to use an unknown `Source` type will result in an Error from the Bridge API.
- `parameters`: A key/value map of configuration parameters for the `Source`
  - Only string for the `key` and `value` of the parameters are supported.
  - The required parameters are `Source` specific and documented in the list of supported `Sources`

## Supported Source Types

The following `Sources` are currently supported by Event Bridge:

### SlackSource

Read messages from a Slack channel (requires a working [bot token](https://api.slack.com/authentication/token-types#bot)).

#### SlackSource Configuration Parameters

* `channel` - The Slack channel name to read messages from.
* `token` - The Slack [bot token](https://api.slack.com/authentication/token-types#bot) needed to connect to the instance and access the channel.

#### Example of creating SlackSource
Can be found at [SourceProcessorDemo](dev/SourceProcessorDemo.md).

#### Example of generated event

This is an example of a CloudEvent generated by a _SlackSource_ every time it reads a new Slack message from the configured channel:

```json
{
  "specversion": "1.0",
  "id": "3ffb0383-e478-4667-89a3-362c35304749",
  "source": "RHOSE",
  "type": "SlackSource",
  "data": {
    "type": "message",
    "team": "T030FKT2TM0",
    "user": "U0307XF2KJH",
    "text": "Hello, World!",
    "blocks": [
      {
        "type": "rich_text",
        "elements": [
          {
            "type": "rich_text_section",
            "elements": [
              {
                "type": "text",
                "text": "Hello, World!"
              }
            ]
          }
        ],
        "blockId": "ylqJ"
      }
    ],
    "ts": "1651568561.160789",
    "is_intro": false,
    "is_starred": false,
    "wibblr": false,
    "displayAsBot": false,
    "upload": false,
    "clientMsgId": "f39ed806-392a-4fb5-a102-cc818aff8164",
    "unfurlLinks": false,
    "unfurlMedia": false,
    "is_thread_broadcast": false,
    "is_locked": false,
    "subscribed": false,
    "hidden": false
  }
}
```
